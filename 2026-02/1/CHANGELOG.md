# Changelog: planned updates (202602)

Table of planned changes: what will be automated, what remains or becomes manual, and where the instructions will be updated.

| Change | Changes to automation | Changes to manual steps | What will be done in instructions and where |
|--------|----------------------|-------------------------|---------------------------------------------|
| **Pre-connection / ZeroTier and SSH first** | None (stays manual by design). | ZeroTier install + join; enable SSH; add key to `~/.ssh/authorized_keys` so Terminus works; optionally edit `sshd_config`; restart ssh or reboot after SSH changes. | **Install-system.md:** New section "0. Before Ubuntu: access and SSH" (or similar). ZeroTier: correct URL `https://install.zerotier.com` (not zeroteir), steps for install + join. SSH: enable SSH, `nano ~/.ssh/authorized_keys`, optional `nano /etc/ssh/sshd_config`, `sudo systemctl restart ssh` or reboot. Cross-reference to SSH key reminder below. |
| **SSH key reminder (installer vs manual)** | None for this item (documentation only). | If not using "Send SSH keys" at Ubuntu install: add Terminus (or other) public key to remote `~/.ssh/authorized_keys` before or right after first SSH. | **Install-system.md** (and optionally **README.md**): If Ubuntu Server installer: remind "Send SSH keys" during install. Otherwise: one sentence to add Terminus/public key to `~/.ssh/authorized_keys` on the server. Note that playbook can add key from repo (see step 4); ensure `ssh-public-keys.txt` contains desired keys. |
| **Deploy Terminus key from repo** | **ubuntu-setup.yml:** In SSH configuration block: ensure `~/.ssh` exists; deploy keys from `ssh-public-keys.txt` via `authorized_key` module (idempotent); guard when file exists. **Mandatory:** set `PasswordAuthentication no` after keys and restart sshd. **SSH config:** ensure each option (Port, PasswordAuthentication, PubkeyAuthentication, PermitRootLogin) appears only once – use lineinfile or single block; do not leave commented `# Port 22` at top and active block at bottom. Leave **ssh-public-keys.txt** as-is (key only). | Reduces manual: no need to edit `authorized_keys` again; lock-down done by playbook. | **Install-system.md** step 4: mention playbook adds keys and disables password auth. **README.md:** one sentence that `ssh-public-keys.txt` is used by the playbook to deploy keys to `authorized_keys`. |
| **Post-reboot checklist and camera settings** | None. | All post-reboot steps remain manual (verify playbook, Firefox, crontab, VNC, VS Code, extensions, clone repo, venv, fwupd disable, touch screen, camera website). New explicit manual tick-off: camera config upload/website setup. | **Setup-post-reboot.md:** Restructure as checklist (`- [ ]` / `- [x]`). Keep all existing commands. Add item 11: Camera settings – upload/configure using `camera-settings/XNZ-L6320AConfigTOBE.bin`; website set up manually. Optional item: minimal X / crane display – install `xdotool`, `x11-xserver-utils` if using server + xinit + king_detector. |
| **Reboot: cron only, remove systemd** | **ubuntu-setup.yml:** Remove section "5. AUTO-REBOOT SYSTEMD TIMER" (do not create daily-reboot.service, daily-reboot.timer, or enable timer). | Scheduled reboots only via root crontab (user sets up manually in post-reboot). | **Setup-post-reboot.md** item 3: document cron as the only reboot mechanism; no "disable systemd" note (timer not installed). |
| **Crontab (exact content)** | None. | Root crontab: `sudo crontab -e` with `0 6,18 * * * /sbin/reboot` and `0 6,18 * * * echo "Cron executed at $(date)" >> /var/log/cron_test.log`. | **Setup-post-reboot.md** checklist item 3: document exactly those two lines. |
| **Touchscreen when using server + xinit (no GNOME)** | None. | Same packages and `/etc/X11/xorg.conf.d/99-touchscreen.conf`; skip GDM-only steps (WaylandEnable in gdm3/custom.conf, `systemctl restart gdm`). | **Setup-post-reboot.md** checklist item 10 (Touch screen): keep existing package and xorg.conf.d steps; add note that when using server + xinit (no GDM), skip the GDM custom.conf edit and "restart gdm"; config is applied when X starts via xinit. |
| **Boot mode prompt at start** | **ubuntu-setup.yml:** Add interactive prompt (same style as Healthchecks URL) near start: "Do you want GNOME to open on boot, or the minimal X / king_detector approach (boot to non-GNOME)?" Store as `boot_mode: gnome` or `boot_mode: minimal_x`. Use later (e.g. when minimal_x: install xdotool, x11-xserver-utils; tailor docs). | User chooses once at setup. | **SETUP_WORKFLOW.md:** Document both paths (GNOME on boot vs minimal X / king_detector) based on choice. Post-reboot checklist can branch or list both. |
| **Network info at playbook start** | **ubuntu-setup.yml:** Early in run (e.g. after prompts): task(s) that gather and **display** for user to record: Ethernet adapters (MAC, current IP, connected or not), WiFi interface MAC(s). Use `ip link` / `ip addr` and format output to stdout. | None (informational only). | Optional: mention in Install-system or SETUP_WORKFLOW that playbook prints network info at start for recording. |
| **Data folders by default** | **ubuntu-setup.yml** or **post-reboot-verify.yml:** Task(s) to create `data/`, `data/jpg/`, `data/video/`, `data/jpg/no_hook`, `data/jpg/no_overlay` under configurable path (e.g. default `~/code/king_detector`). Always run in normal playbook/verify run, not optional. | Fallback: manual `mkdir -p` if path not used. | **Setup-post-reboot.md:** Item 12 can reference "created by playbook by default" or document manual step if path differs. |
| **SETUP_WORKFLOW.md and README link** | None. | All manual vs automated steps documented in one place. | **New SETUP_WORKFLOW.md:** Intended workflow; boot mode choice at playbook start (GNOME vs minimal X); what's automated (keys, lock-down, data folders, network info at start); what stays manual. Camera settings and `camera-settings/` reference. **README.md:** One-line pointer to SETUP_WORKFLOW.md; one sentence that `ssh-public-keys.txt` is used by the playbook. |
| **Target deployment (server + minimal X + crane display)** | Handled by boot mode prompt; when minimal_x, playbook installs xdotool, x11-xserver-utils (no king_detector tasks in this repo). | Crane-display service and scripts in king_detector. | **SETUP_WORKFLOW.md:** Document both paths from boot mode choice; deps for minimal X path. |
| **SSH config single-place (no duplicate options)** | **ubuntu-setup.yml:** Manage `/etc/ssh/sshd_config` so Port, PasswordAuthentication, PubkeyAuthentication, PermitRootLogin each appear once (lineinfile to set in place, or one managed block; do not append block that leaves `# Port 22` etc. at top). | None. | **Install-system.md:** "Optional: Lock Down SSH" block replaced by note that playbook configures SSH and disables password auth; no need to document "messy" duplicate options. |
| **Ongoing CHANGELOG and DECISIONS at repo root** | None (docs only). | Maintain CHANGELOG.md and DECISIONS.md when making changes or decisions. | **Repo root:** Create **CHANGELOG.md** – ongoing log of what changes were made to the script(s), when, and where. Create **DECISIONS.md** – ongoing log of what decisions were made and why. Populate with first entries when implementing this plan; append whenever script changes or decisions are made. |
| **Git setup (SSH default, key for GitHub)** | **ubuntu-setup.yml:** New section: (1) Set git `user.name` and `user.email` (prompt or vars). (2) `git config --global url."git@github.com:".insteadOf "https://github.com/"`. (3) Generate ed25519 SSH key for `ssh_user` (e.g. `~/.ssh/id_ed25519_github`). (4) Display public key to stdout. (5) Pause: "Add this key to GitHub (Settings → SSH and GPG keys → New SSH key), then press Enter to continue." Optional: `~/.ssh/config` for Host github.com IdentityFile. | User adds the displayed public key to their GitHub account (one-time). | **Install-system.md** or **Setup-post-reboot.md:** Note that playbook configures Git and generates a GitHub SSH key; user is prompted to add it. **SETUP_WORKFLOW.md:** Include Git/SSH setup in automated steps. |
